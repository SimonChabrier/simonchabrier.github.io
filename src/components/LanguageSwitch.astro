---
const { lang = 'fr' } = Astro.props;
---
<div class="no-print inline-flex items-center">
  <label for="languageSwitch" class="sr-only">Choisir la langue</label>
  <select id="languageSwitch" name="languageSwitch" class="block w-full rounded-md border-0 py-1.5 pl-3 pr-10 text-skin-base ring-1 ring-inset ring-skin-muted focus:ring-2 focus:ring-skin-hue dark:text-white sm:text-sm sm:leading-6">
    <option value="fr" class="dark:text-white">Fran√ßais</option>
    <option value="en" class="dark:text-white">English</option>
  </select>

  <script>
    const select = document.getElementById('languageSwitch');
    const saved = localStorage.getItem('lang');
    const pathLang = window.location.pathname.startsWith('/en') ? 'en' : 'fr';
    const current = saved || pathLang;
    select.value = current;
    if (saved && saved !== pathLang) {
      if (saved === 'en') {
        window.location.pathname = '/en/';
      } else {
        window.location.pathname = '/';
      }
    }
    select.addEventListener('change', () => {
      const value = select.value;
      localStorage.setItem('lang', value);
      if (value === 'en') {
        window.location.pathname = '/en/';
      } else {
        window.location.pathname = '/';
      }
    });
  </script>
</div>
